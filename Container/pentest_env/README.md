# ToN-IoT Federated Learning Model â€“ Live Pentest

This folder contains a complete, secure, and production-like environment to test the robustness of your trained FedProx models against real-world attacks (DDoS, HTTP flood, slowloris, injection, etc.).

## Features
- FastAPI inference server with all 4 trained models loaded
- Isolated Kali Linux attacker container with pre-installed tools:
  - `hping3`, `slowhttptest`, `ab`, `sqlmap`, `nmap`, `GoldenEye`
- Fully hardened containers (rootless-ready with Podman)
- Network isolation: attacker can only reach the model API (localhost:8000)
- Zero risk to host machine when using Podman (recommended)

## Requirements
- Podman (recommended) or Docker
- Trained models in `../trained_models/` folder

## Quick Start (One Command)
```bash
cd pentest_env
chmod +x start.sh
./start.sh
```

Then enter the attacker container:
```bash
podman exec -it kali_attacker bash    # or docker exec
```

## Attack Examples (run inside attacker container)

```bash
# Health check
curl http://localhost:8000/health

# Normal prediction
curl -X POST http://localhost:8000/predict/mlp_binary -H "Content-Type: application/json" -d '{"features": [0.1, 0.2, ...]}'

# DDoS / Flood attacks
hping3 -S --flood -p 8000 127.0.0.1
slowhttptest -c 1000 -H -r 200 -t GET -u http://127.0.0.1:8000/health
ab -n 100000 -c 2000 http://127.0.0.1:8000/health
python3 /opt/goldeneye/goldeneye.py http://127.0.0.1:8000 -w 50 -s 1000

# Injection attempts
sqlmap -u "http://127.0.0.1:8000/predict/mlp_binary" --data='{"features":[1,2,3]}' --level 5
```

## Security Notes
- All containers run with `no-new-privileges`, `read_only` filesystem, dropped capabilities
- Using **Podman rootless** = maximum security (no daemon, no root privilege)
- Attacker container can only communicate with the model service

## Cleanup
```bash
podman-compose down -v    # or docker compose down -v
```